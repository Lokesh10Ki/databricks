common_permissions: &permissions
  permissions:
    - level: CAN_QUERY
      group_name: field-eng-only

resources:
  model_serving_endpoints:
    uc_model_serving_endpoint:
      name: 'app-model-endpoint'
      config:
        served_entities:
          - entity_name: 'system.ai.meta_llama_v3_1_8b_instruct'
            name: 'meta_llama_v3_1_8b_instruct-3'
            entity_version: '3'
            workload_size: Small
            scale_to_zero_enabled: true
        traffic_config:
          routes:
            - served_model_name: 'meta_llama_v3_1_8b_instruct-3'
              traffic_percentage: 100
      ai_gateway:
        inference_table_config:
          catalog_name: ${var.catalog_name}
          schema_name: genai_prompt
        usage_tracking_config:
          enabled: true
      <<: *permissions